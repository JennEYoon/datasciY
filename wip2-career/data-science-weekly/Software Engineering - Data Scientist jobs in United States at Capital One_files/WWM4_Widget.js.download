/* 
WWM4 - Widget Functionalities
Bhuvanesh, bhuvanesh.mohankumar@tmp.com, TMP Worldwide, LLC
*/

var rstPostingUrl = "";
var PostingUrl = "../Handlers/Widget.ashx";
//BERT-7068 starts...
var snTwitter = 'twitter';
var snLinkedIn = 'linkedin';
var snTwitterMaxLen = '40';
var snLinkedInMaxLen = '68';

var socialNetwork = null;
var widgetResponse = null;
var emailResponse = null;

var senderaddress = null;
var recepientaddress = null;
var shareemailmsg = null;
//BERT-7068 ends

function checkEmail(value) {
    if (!(value == '')) {
        var emailfilter = /^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/;

        var returnval = emailfilter.test(value);
        if (returnval == false) {
            return false;
        }
        else {
            return true;
        }
    }
}



function validateMultipleEmailsCommaSeparated(value) {

    if (value.split(",") != null) {
        var result = value.split(",");
        for (var i = 0; i < result.length; i++)
            if (!checkEmail(result[i]))
            return false;
        return true;
    }
    else {

        var result = value.split(",");
        for (var i = 0; i < result.length; i++)
            if (!checkEmail(result[i]))
            return false;
        return true;
    }
}




function ShareJob(Network, shareUrlLnk) {

    document.getElementById('divNetworkResult').style.display = 'block';
    if (document.all) {
        document.getElementById('divNetworkResult').innerText = "Processing......";
    }
    else {
        document.getElementById('divNetworkResult').innerHTML = "Processing......";
    }
    $.post(rstPostingUrl, { shareNetwork: Network, shareUrl: shareUrlLnk }, function(data) {
        document.getElementById('divNetworkResult').style.display = 'block';
        if (document.all) {
            var newdiv = document.createElement("div");
            newdiv.innerHTML = data;
            document.getElementById('divNetworkResult').appendChild(newdiv);
        }
        else {
            document.getElementById('divNetworkResult').innerHTML = data;
        }
    });
}



//Check Characters fieldname, remainingname, maxchars
function CheckFieldLength() {
    var arguments = CheckFieldLength.arguments;
    var fn = arguments[0];
    var rn = arguments[1];
    var mc = arguments[2];


    var len = fn.value.length;
    if (len > mc) {
        fn.value = fn.value.substring(0, mc);
        len = mc;
    }
    //BERT-7068 starts...
    document.getElementById('show-email-msg-charcount').innerHTML = mc - len;
    //BERT-7068 ends
}

//Check Characters fieldname, remainingname, maxchars
function CheckFieldLengthLn() {
    var arguments = CheckFieldLengthLn.arguments;
    var fn = arguments[0];
    var rn = arguments[1];
    var mc = arguments[2];


    var len = fn.value.length;
    if (len > mc) {
        fn.value = fn.value.substring(0, mc);
        len = mc;
    }
    document.getElementById('remainingLn').innerHTML = mc - len;

}

//Check Characters fieldname, remainingname, maxchars
function CheckFieldLengthTw() {
    var arguments = CheckFieldLengthTw.arguments;
    var fn = arguments[0];
    var rn = arguments[1];
    var mc = arguments[2];


    var len = fn.value.length;
    if (len > mc) {
        fn.value = fn.value.substring(0, mc);
        len = mc;
    }
    document.getElementById('remainingTw').innerHTML = mc - len;

}

function modalPopup(layer_ref) {

    //BERT-7068 starts...
    var wwm4widgetjobshare = document.getElementById("wwm4widget-job-share");
    if (wwm4widgetjobshare && wwm4widgetjobshare.style) {
        if (!wwm4widgetjobshare.set) { wwm4widgetjobshare.set = true; Ary.push(wwm4widgetjobshare); }
        wwm4widgetjobshare.style.display = (wwm4widgetjobshare.style.display == '') ? 'none' : '';
    }
    //BERT-7068 ends   
}



function SendEmail(Network, shareUrlLnk) {



    document.getElementById('divNetworkResult').style.display = 'block';
    var strProcessMessage = "Processing......";
    if (document.getElementById("txtEmailAddress").value == "") {
        strProcessMessage = "Please enter valid Email address!";
        if (document.all) {
            document.getElementById('divNetworkResult').innerText = strProcessMessage;
        }
        else {
            document.getElementById('divNetworkResult').innerHTML = strProcessMessage;
        }
        return false;
    }
    if (checkEmail(document.getElementById("txtEmailAddress").value) == false) {
        strProcessMessage = "Please enter valid Email address!";
        if (document.all) {
            var newdiv = document.createElement("div");
            newdiv.innerHTML = data;
            document.getElementById('divNetworkResult').appendChild(newdiv);
            document.getElementById('divNetworkResult').innerText = strProcessMessage;
        }
        else {
            document.getElementById('divNetworkResult').innerHTML = strProcessMessage;
        }
        return false;
    }
    $.post(rstPostingUrl, { shareNetwork: Network, EmailAddress: document.getElementById("txtEmailAddress").value, EmailMessage: document.getElementById("txtEmailMessage").value, EmailSubject: 'Existing opportunity', shareUrl: shareUrlLnk },
    function(data) {
        document.getElementById('divNetworkResult').style.display = 'block';
        if (document.all) {
            var newdiv = document.createElement("div");
            newdiv.innerHTML = data;
            document.getElementById('divNetworkResult').appendChild(newdiv);
        }
        else {
            document.getElementById('divNetworkResult').innerHTML = data;
        }
        //BERT-7068 starts...        
        document.getElementById("wwm4widget-job-share").style.display = 'none';
        //BERT-7068 ends
    });
}

//BERT-7068 starts...
function CloseShareDiv() {

    if (document.getElementById("wwm4widget-job-share") != null) {
        document.getElementById("wwm4widget-job-share").style.display = "none";
        $('#wwm4widget-job-share').empty();
    }

    if (document.getElementById("blanket") != null) {
        document.getElementById('blanket').style.display = 'none';
    }
    else {
        //Adding a blanket container to the page
        if (document.getElementById("divMain") != null) {
            $('<div id="blanket" class="blanket" style="display:none;"></div>').appendTo('#divMain');
        }
    }
}

function ShowEmailDiv() {
  
    //var divFbSocialNetworkMsg = document.getElementById("divFbSocialNetworkMsg"); /// BERT 7333
    var wwm4widgetjobshare = document.getElementById("wwm4widget-job-share");  
    var txtRecipientAddress = document.getElementById("email-share-toaddress");
    var txtEmailMessage = document.getElementById("email-share-message");

    //divFbSocialNetworkMsg.style.display = "none";/// BERT 7333    
    if (document.getElementById('wwm4widget-job-share') != null && document.getElementById('wwm4widget-job-share').style.display == 'block') {
        document.getElementById('wwm4widget-job-share').style.display = 'none';
        $('#wwm4widget-job-share').empty();
        if (document.getElementById("blanket") != null) {
            document.getElementById('blanket').style.display = 'none';
        }
        else {
            //Adding a blanket container to the page
            if (document.getElementById("divMain") != null) {
                $('<div id="blanket" class="blanket" style="display:none;"></div>').appendTo('#divMain');
            }
        }
        txtRecipientAddress.value = '';
        if (emailResponse != null) {
            var hdntxtEmailMessage = emailResponse.EmailPopupMessageBody;
            txtEmailMessage.value = hdntxtEmailMessage;
        }
    }

    else if (emailResponse == null) {
    try {
        emailResponse = emailPopupContent;
    }
    catch (e) {
    }
    processEmailResponse(emailResponse);
    }
    else {
        processEmailResponse(emailResponse);
    }
    //FB.Canvas.setSize({ height: $('body').height() });
}

function showEmailShare(varEmailShareAction) {

    var emailPopUpHeaderTitle = document.getElementById("show-email-share-title");
    var lnkEmailShareClose = document.getElementById("email-share-closelnk");
    var lblMyEmailAddress = document.getElementById("show-email-share-fromaddressheader");
    var lblRecipientMessage = document.getElementById("show-email-share-toaddressheader");
    var lblEmailMessage = document.getElementById("show-email-share-msgheader");
    var lnkMailCancel = document.getElementById("email-share-closebtn");

    //Email   
    var txtMyEmailAddress = document.getElementById("email-share-fromaddress");
    var txtRecipientMessage = document.getElementById("email-share-toaddress");
    var txtEmailMessage = document.getElementById("email-share-message");
    var remaining = document.getElementById("show-email-msg-charcount");
    var emailMsgCharsRemainingText = document.getElementById("show-email-msg-remcharcount");
    var lnkMailSend = document.getElementById("email-share-sendbtn");

    //Email sent
    var txtMyEmailAddressSent = document.getElementById("show-email-share-fromaddress");
    var txtRecipientMessageSent = document.getElementById("show-email-share-toaddress");
    var txtEmailMessageSent = document.getElementById("show-email-share-msg");

    var emailMaxLen = 500;

    if (document.getElementById("wwm4widget-job-share") != null) {
        document.getElementById("wwm4widget-job-share").style.display = "block";
    }

    if (document.getElementById('blanket') != null) {
        document.getElementById('blanket').style.display = 'block';
    }
    else {
        //Adding a blanket container to the page
        if (document.getElementById("divMain") != null) {
            $('<div id="blanket" class="blanket" style="display:none;"></div>').appendTo('#divMain');
        }
        document.getElementById('blanket').style.display = 'block';
    }

    switch (varEmailShareAction) {
        case 'sendEmail':
            if (emailResponse != null) {
                emailPopUpHeaderTitle.innerHTML = emailResponse.EmailPopupTitle;
                lnkEmailShareClose.title = emailResponse.EmailPopupClose;
                lblMyEmailAddress.innerHTML = emailResponse.EmailPopupSenderEmailTitle;
                lblRecipientMessage.innerHTML = emailResponse.EmailPopupRecipEmailTitle;
                lblEmailMessage.innerHTML = emailResponse.EmailPopupBodyTitle;
                txtEmailMessage.innerHTML = emailResponse.EmailPopupMessageBody;
                txtEmailMessage.value = emailResponse.EmailPopupMessageBody;
                emailMsgCharsRemainingText.innerHTML = emailResponse.EmailPopupCharsRemain;
                lnkMailCancel.title = emailResponse.EmailPopupCancel;
                lnkMailCancel.innerHTML = emailResponse.EmailPopupCancel;
                lnkMailSend.title = emailResponse.EmailPopupSend;
                lnkMailSend.innerHTML = emailResponse.EmailPopupSend;
            }

            remaining.innerHTML = emailMaxLen - txtEmailMessage.value.length;
            if (document.getElementById("hdnEmpEmail") != null && document.getElementById("hdnEmpEmail").value != '') {
                txtMyEmailAddress.value = document.getElementById("hdnEmpEmail").value;
            }
            if (txtMyEmailAddress.value == document.getElementById("hdnEmpEmail").value && txtMyEmailAddress.value != '') {
                txtMyEmailAddress.disabled = true;
            }

            lnkEmailShareClose.onclick = function() { ShowEmailDiv(); };
            txtEmailMessage.onblur = function() { EmailMsgFillText(); };
            txtEmailMessage.onkeyup = function() { CheckFieldLength(txtEmailMessage, remaining, emailMaxLen); };
            txtEmailMessage.onkeydown = function() { CheckFieldLength(txtEmailMessage, remaining, emailMaxLen); };
            txtEmailMessage.onmouseout = function() { CheckFieldLength(txtEmailMessage, remaining, emailMaxLen); };
            lnkMailCancel.onclick = function() { ShowEmailDiv(); };
            lnkMailSend.onclick = function() { return SendMyEmail(); };
            break;
        case 'emailSent':
            if (emailResponse != null) {
                emailPopUpHeaderTitle.innerHTML = emailResponse.EmailPopupSentMsg;
                lnkEmailShareClose.title = emailResponse.EmailPopupClose;
                lblMyEmailAddress.innerHTML = emailResponse.EmailPopupSenderEmailTitle;
                lblRecipientMessage.innerHTML = emailResponse.EmailPopupRecipEmailTitle;
                lblEmailMessage.innerHTML = emailResponse.EmailPopupBodyTitle;
                lnkMailCancel.title = emailResponse.EmailPopupClose;
                lnkMailCancel.innerHTML = emailResponse.EmailPopupClose;
                if (senderaddress != null) {
                    txtMyEmailAddressSent.innerHTML = senderaddress;
                }
                if (recepientaddress != null) {
                    txtRecipientMessageSent.innerHTML = recepientaddress;
                }
                if (shareemailmsg != null) {
                    txtEmailMessageSent.innerHTML = shareemailmsg;
                }
            }

            lnkEmailShareClose.onclick = function() { CloseEmailDiv(); };
            lnkMailCancel.onclick = function() { CloseEmailDiv(); };
            break;
        default:
            break;
    }
}
//BERT-7068 ends

function showPopup(url) {
    newwindow = window.open(url, 'name', 'height=380,width=680,top=200,left=300,resizable');
    if (window.focus) { newwindow.focus() }
}


function CloseEmailDiv(url) {

    //BERT-7068 starts...  
    var wwm4widgetjobshare = document.getElementById("wwm4widget-job-share");

    if (document.getElementById("blanket") != null) {
        document.getElementById('blanket').style.display = 'none';
    }
    else {
        //Adding a blanket container to the page
        if (document.getElementById("divMain") != null) {
            $('<div id="blanket" class="blanket" style="display:none;"></div>').appendTo('#divMain');
        }
    }
    wwm4widgetjobshare.style.display = "none";
    $('#wwm4widget-job-share').empty();
    //BERT-7068 ends
}

function toggle() {
    var nonEmp = document.getElementById("divShareLink");
    var emplogin = document.getElementById("divEmplogins");
    var divInvalidUser = document.getElementById("divInvalidUser");

    var forgotPassword = document.getElementById("divForgotPassword");

    var forgotPasswordConfirmation = document.getElementById("divForgotPasswordConfirmation");
    var forgotPasswordInvalid = document.getElementById("divForgotPasswordInvalidEmail");

    //BERT-4516 starts...
    var empLoginAccActivation = document.getElementById("divEmpActivationMail");
    var empAccountActivation = document.getElementById("divAccountActivation");
    var empLogDetail = document.getElementById("divEmpLogAccount");
    var nonEmpLink = document.getElementById("divLinkNonEmp");
    //BERT-4516 ends



    forgotPassword.style.display = "none";
    //    forgotPasswordConfirmation.style.display = "none";  //Sprint:3 US: WWM 3.15 //Forgot Password Back Link
    //    forgotPasswordInvalid.style.display = "none"; //Sprint:3 //Forgot Password Invalid Email address Back Link

    if (nonEmp.style.display == "block") {
        nonEmp.style.display = "none";
        emplogin.style.display = "block";
        try {
            divInvalidUser.style.display = "none";
        } catch (err) { }


        successCookieHandler();
    }
    //Sprint:3 US: WWM 3.15 starts... 
    else if (forgotPasswordConfirmation.style.display == "block") {
        forgotPasswordConfirmation.style.display = "none";
        emplogin.style.display = "block";
        try {
            divInvalidUser.style.display = "none";
        } catch (err) { }
    }
    //Sprint:3 US: WWM 3.15 ends

    //Sprint:3 divForgotPasswordInvalidEmail starts...
    else if (forgotPasswordInvalid.style.display == "block") {
        forgotPasswordInvalid.style.display = "none";
        emplogin.style.display = "block";
        try {
            divInvalidUser.style.display = "none";
        } catch (err) { }
    }
    //Sprint:3 divForgotPasswordInvalidEmail ends
    //BERT-4516 starts...
    else if (emplogin.style.display == "block" && empLoginAccActivation.style.display == "block") {
        emplogin.style.display = "none";
        empLogDetail.style.display = "none";
        empLoginAccActivation.style.display == "none";
        nonEmpLink.style.display == "none";
        empAccountActivation.style.display = "block";

        try {
            divInvalidUser.style.display = "none";
        } catch (err) { }
    }
    else if (empAccountActivation.style.display == "block") {
        empAccountActivation.style.display = "none";
        emplogin.style.display = "block";
        empLogDetail.style.display = "block";
        nonEmpLink.style.display = "block";
        empLoginAccActivation.style.display = "none";
        try {
            divInvalidUser.style.display = "none";
        } catch (err) { }
    }
    //BERT-4516 ends
    //BERT-5358 starts...
    else if (divInvalidUser.style.display == "block") {
        divInvalidUser.style.display = "none";
        emplogin.style.display = "block";
    }
    //BERT-5358 ends
    else {
        nonEmp.style.display = "block";
        forgotPasswordConfirmation.style.display = "none"; //Sprint:3 US: WWM 3.15
        emplogin.style.display = "none";
        try {
            divInvalidUser.style.display = "none";
        } catch (err) { }
    }
}

//BERT 6539
function toggleHome() {
    var nonEmp = document.getElementById("divShareLink");
    var emplogin = document.getElementById("divEmplogins");
    var divInvalidUser = document.getElementById("divInvalidUser");

    var forgotPassword = document.getElementById("divForgotPassword");

    var forgotPasswordConfirmation = document.getElementById("divForgotPasswordConfirmation");
    var forgotPasswordInvalid = document.getElementById("divForgotPasswordInvalidEmail");


    var empLoginAccActivation = document.getElementById("divEmpActivationMail");
    var empAccountActivation = document.getElementById("divAccountActivation");
    var empLogDetail = document.getElementById("divEmpLogAccount");
    var nonEmpLink = document.getElementById("divLinkNonEmp");

    try {
        nonEmp.style.display = "block";
        emplogin.style.display = "none";
        forgotPassword.style.display = "none";
        forgotPasswordConfirmation.style.display = "none";
        forgotPasswordInvalid.style.display = "none";
        empLoginAccActivation.style.display = "none";
        empAccountActivation.style.display = "none";
       
        nonEmpLink.style.display = "none";
        divInvalidUser.style.display = "none";
    } catch (err) { }
}
//BERT 6539


//BERT-5358 starts...
function showWidget(WidgetName) {
    var nonEmp = document.getElementById("divShareLink");
    var divInvalidUser = document.getElementById("divInvalidUser");
    if (WidgetName == 'NonEmployee') {
        if (divInvalidUser.style.display == "block") {
            nonEmp.style.display = "block";
            divInvalidUser.style.display = "none";
        }
    }
}
//BERT-5358 ends

function showForgotPassword() {
    var nonEmp = document.getElementById("divShareLink");
    var emplogin = document.getElementById("divEmplogins");
    var forgotPassword = document.getElementById("divForgotPassword");
    var divInvalidUser = document.getElementById("divInvalidUser");
    var forgotPasswordConfirmation = document.getElementById("divForgotPasswordConfirmation");
    var forgotPasswordInvalid = document.getElementById("divForgotPasswordInvalidEmail");



    nonEmp.style.display = "none";
    emplogin.style.display = "none";
    forgotPassword.style.display = "block";
    forgotPasswordConfirmation.style.display = "none";
    forgotPasswordInvalid.style.display = "none";
    try {

        divInvalidUser.style.display = "none";
    } catch (err) { }



}
function showForgotPasswordConfirmation() {
    var nonEmp = document.getElementById("divShareLink");
    var emplogin = document.getElementById("divEmplogins");
    var forgotPassword = document.getElementById("divForgotPassword");
    var forgotPasswordConfirmation = document.getElementById("divForgotPasswordConfirmation");
    var forgotPasswordInvalid = document.getElementById("divForgotPasswordInvalidEmail");
    var divInvalidUser = document.getElementById("divInvalidUser");




    nonEmp.style.display = "none";
    emplogin.style.display = "none";
    forgotPassword.style.display = "none";
    forgotPasswordConfirmation.style.display = "block";
    forgotPasswordInvalid.style.display = "none";
    try {

        divInvalidUser.style.display = "none";
    } catch (err) { }

    // BERT - 4521 - Start
    $("#lnkEmployeeLogin").focus();
    // BERT - 4521 - End
}

function showForgotPasswordInvalidEmail() {
    var nonEmp = document.getElementById("divShareLink");
    var emplogin = document.getElementById("divEmplogins");
    var forgotPassword = document.getElementById("divForgotPassword");
    var forgotPasswordConfirmation = document.getElementById("divForgotPasswordConfirmation");
    var forgotPasswordInvalid = document.getElementById("divForgotPasswordInvalidEmail");
    var divInvalidUser = document.getElementById("divInvalidUser");




    nonEmp.style.display = "none";
    emplogin.style.display = "none";
    forgotPassword.style.display = "none";
    forgotPasswordConfirmation.style.display = "none";
    forgotPasswordInvalid.style.display = "block";
    try {

        divInvalidUser.style.display = "none";
    } catch (err) { }


    // BERT - 4521 - Start
    $("#lnkForgetInvalidEmail").focus();
    // BERT - 4521 - End

}

//BERT-7068 starts...
function SendMyEmail() {

    var divSocialNetworkShare = document.getElementById("show-load-imgbox");
    var wwm4widgetjobshare = document.getElementById('wwm4widget-job-share');

    clearEmailErrors();
    wwm4widgetjobshare.style.display = "block";

    var myEmail = document.getElementById("email-share-fromaddress");
    var recipientEmail = document.getElementById("email-share-toaddress");
    var messageEmail = document.getElementById("email-share-message");
    senderaddress = myEmail.value;
    recepientaddress = recipientEmail.value;
    shareemailmsg = messageEmail.value;

    if (senderaddress == '') {
        showEmailError();
        if ((myEmail != null) && (document.getElementById("check-sender-email-error") == null)) {
            $('<p id="check-sender-email-error" class="email-error"></p>').insertAfter(myEmail);
        }
        document.getElementById("check-sender-email-error").style.display = "block";
    }
    if (recepientaddress == '') {
        showEmailError();
        if ((recipientEmail != null) && (document.getElementById("check-recipient-email-error") == null)) {
            $('<p id="check-recipient-email-error" class="email-error"></p>').insertAfter(recipientEmail);
        }
        document.getElementById("check-recipient-email-error").style.display = "block";
    }
    if (shareemailmsg == '') {
        showEmailError();
        if ((messageEmail != null) && (document.getElementById("check-email-msg") == null)) {
            $('<p id="check-email-msg" class="email-error"></p>').insertAfter(messageEmail);
        }
        document.getElementById("check-email-msg").style.display = "block";
    }

    var myEmailErrorRequired = document.getElementById("check-sender-email-error");
    var recipientEmailErrorRequired = document.getElementById("check-recipient-email-error");
    var messageEmailErrorRequired = document.getElementById("check-email-msg");
    var messageEmailSent = document.getElementById("check-email-share-fields");

    if (emailResponse != null) {
        if (messageEmailSent != null) {
            messageEmailSent.innerHTML = emailResponse.EmailPopupError1;
        }
        if (myEmailErrorRequired != null) {
            myEmailErrorRequired.innerHTML = emailResponse.EmailPopupSenderError;
        }
        if (recipientEmailErrorRequired != null) {
            recipientEmailErrorRequired.innerHTML = emailResponse.EmailPopupReciperError;
        }
        if (messageEmailErrorRequired != null) {
            messageEmailErrorRequired.innerHTML = emailResponse.EmailPopupMsgRequired;
        }
    }
    if (checkEmail(senderaddress) == true) {

        if ((validateMultipleEmailsCommaSeparated(recepientaddress) == true)) {
            if (shareemailmsg != '') {               
                var txtMyEmailAddress = document.getElementById("email-share-fromaddress");
                var txtRecipientMessage = document.getElementById("email-share-toaddress");
                var txtEmailMessage = document.getElementById("email-share-message");

                var fromEmail = txtMyEmailAddress.value;
                var toEmail = txtRecipientMessage.value;
                var msgEmail = txtEmailMessage.value;
                showLoadImage();

                try {
                    var hdnCurrentUrl = document.getElementById("hdnCurrentUrl");
                }
                catch (err) {
                    hdnCurrentUrl.value = "NonEmployee";
                }
                var strUrl = "/Handlers/WidgetSocialShare.ashx?SocialNetwork=email&fromEmail=" + fromEmail + "&toEmail=" + toEmail + "&msgEmail=" + msgEmail + "&CurrentURL=" + hdnCurrentUrl.value;
                //                window.open(strUrl, "test", "width=10,height=10,resizable=no,center=no,z-lock=no");
                //                $(window)[0].parent.focus()

                //BERT 8371 Start
                if (strUrl.indexOf("#") >= 0) {
                    var Re = new RegExp("#", "g");
                    strUrl = strUrl.replace(Re, "%23");
                }
                //BERT 8371 End

                RaiseRequestToHandler(strUrl);

                //                return false;

                //Clear Email Fileds Start
                txtRecipientMessage.value = "";

                if (emailResponse != null) {
                    var hdntxtEmailMessage = emailResponse.EmailPopupMessageBody; //document.getElementById("hdntxtEmailMessage").value;
                    txtEmailMessage.value = hdntxtEmailMessage;
                }

                //End
            } else {
                messageEmailErrorRequired.style.display = "block";
                messageEmailSent.style.display = "block";
            }
        }
        else {
            recipientEmailErrorRequired.style.display = "block";
        }
    } else {
        myEmailErrorRequired.style.display = "block";
    }
}

function showEmailError() {
    var checkemailsharefields = document.getElementById("check-email-share-fields");
    var fromaddressheader = document.getElementById("show-email-share-fromaddressheader");
    if ((fromaddressheader != null) && (checkemailsharefields == null)) {
        $('<p id="check-email-share-fields" class="email-error"></p>').insertBefore(fromaddressheader);
    }
    document.getElementById("check-email-share-fields").style.display = "block";
}

function clearEmailErrors() {
    var myEmailErrorRequired = document.getElementById("check-sender-email-error");
    var recipientEmailErrorRequired = document.getElementById("check-recipient-email-error");
    var messageEmailErrorRequired = document.getElementById("check-email-msg");
    var messageEmailSent = document.getElementById("check-email-share-fields");

    if (myEmailErrorRequired != null) {
        myEmailErrorRequired.style.display = "none";
    }
    if (recipientEmailErrorRequired != null) {
        recipientEmailErrorRequired.style.display = "none";
    }
    if (messageEmailErrorRequired != null) {
        messageEmailErrorRequired.style.display = "none";
    }
    if (messageEmailSent != null) {
        messageEmailSent.style.display = "none";
    }
}
//BERT-7068 ends

function forgetPassword() {
    alert('forgetPassword');
}

function successLoginHandler() {

    var hdnCurrentUrl = document.getElementById("hdnCurrentUrl").value;
    var hdnstrImage = document.getElementById("hdnstrImage").value;
    var hdnJobTitle = document.getElementById("hdnJobTitle").value;

    var emailErrorRequired = document.getElementById("emailErrorRequired");
    var emailError = document.getElementById("emailErrorInvalid");

    var passwordErrorRequired = document.getElementById("passwordErrorRequired");

    emailErrorRequired.style.display = "none";
    emailError.style.display = "none";
    passwordErrorRequired.style.display = "none";

    var email = document.getElementById("txtEmailId").value;
    var Password = document.getElementById("txtPassword").value;

    //BERT-4518 starts...
    var isRememberDetailsChecked = $('#cbRememberMe').attr('checked') ? 1 : 0;
    //BERT-4518 ends

    if ((email == 'Email Address')) {
        emailErrorRequired.style.display = "block";

        if ((Password == 'Password') || (Password == '')) {
            passwordErrorRequired.style.display = "block";
            return false;
        }
        return false;
    }
    if ((checkEmail(email) == true) && (Password != '')) {


        //        var strUrl = "/Handlers/WidgetEmployeeLogin.ashx?Email=" + email + "&Password=" + Password;
        //BERT-4518 starts...
        var strUrl = "/Handlers/WidgetEmployeeLogin.ashx?Email=" + email + "&Password=" + Password + "&currentUrl=" + hdnCurrentUrl + "&strImage=" + hdnstrImage + "&jobTitle=" + hdnJobTitle + "&RememberDetails=" + isRememberDetailsChecked;
        //BERT-4518 ends
        //        window.open(strUrl, "test", "width=10,height=10,resizable=no,center=no,z-lock=no");
        //        $(window)[0].parent.focus()

        RaiseRequestToHandler(strUrl);

    }
    else {
        emailError.style.display = "block";
        if ((Password == 'Password') || (Password == '')) {
            passwordErrorRequired.style.display = "block";
        }
    }
    if ((Password == 'Password') || (Password == '')) {
        passwordErrorRequired.style.display = "block";
        return false;
    }


}

function RaiseRequestToHandler(Url) {

    $.post(Url, function(arg) {

        var methodName = GetMethodName(arg);
        var parameters = GetParameters(arg);

        CallFunctionFromString(methodName, parameters);

    }).error(function() { alert("error"); });

}

function GetMethodName(arguments) {

    var methodName = arguments.split("|");

    return methodName[0];

}

function GetParameters(arguments) {
    var functionSplit = arguments.split("|");
    if (functionSplit.length > 1) {
        var parameters = functionSplit[1].split(",");

        if (parameters.length > 0) {

            return parameters;

        }
        return [''];
    }
    return [''];


}

function CallFunctionFromString(name, arguments) {
    var fn = window[name];
    if (typeof fn !== 'function')
        return;

    fn.apply(window, arguments);
}


function successCookieHandler() {
    var hdnCurrentUrl = document.getElementById("hdnCurrentUrl").value;
    var hdnstrImage = document.getElementById("hdnstrImage").value;
    var hdnJobTitle = document.getElementById("hdnJobTitle").value;

    //    var strUrl = "/Handlers/WidgetEmployeeLogin.ashx?Email=" + "LoggedInUser" + "&Password=" + "LoggedInUser";
    var strUrl = "/Handlers/WidgetEmployeeLogin.ashx?Email=" + "LoggedInUser" + "&Password=" + "LoggedInUser" + "&currentUrl=" + hdnCurrentUrl + "&strImage=" + hdnstrImage + "&jobTitle=" + hdnJobTitle;
    //    window.open(strUrl, "test", "width=10,height=10,resizable=no,center=no,z-lock=no");
    //    $(window)[0].parent.focus()

    RaiseRequestToHandler(strUrl);

}

//BERT 4518 - Start
function LoginHandlerAtLoadTime() {
    //BERT 5543 - Start
    try {
        var hdnCurrentUrl = document.getElementById("hdnCurrentUrl").value;
        var hdnstrImage = document.getElementById("hdnstrImage").value;
        var hdnJobTitle = document.getElementById("hdnJobTitle").value;

        var strUrl = "/Handlers/WidgetEmployeeLogin.ashx?Email=" + "LoggedInUser" + "&Password=" + "LoggedInUser" + "&currentUrl=" + hdnCurrentUrl + "&strImage=" + hdnstrImage + "&jobTitle=" + hdnJobTitle + "&IsLoadTimeCheck=True";
        RaiseRequestToHandler(strUrl);
    }
    catch (error) {
    }
    //BERT 5543 - End
}

function userLoginCheck() {

    var nonEmp = document.getElementById("divShareLink");
    var emplogin = document.getElementById("divEmplogins");
    var divInvalidUser = document.getElementById("divInvalidUser");

    var forgotPassword = document.getElementById("divForgotPassword");

    var forgotPasswordConfirmation = document.getElementById("divForgotPasswordConfirmation");
    var forgotPasswordInvalid = document.getElementById("divForgotPasswordInvalidEmail");

    nonEmp.style.display = "block";
    forgotPassword.style.display = "none";
    forgotPasswordConfirmation.style.display = "none";
    emplogin.style.display = "none";

    try {
        divInvalidUser.style.display = "none";
    } catch (err) { }

}
//BERT 4518 - End

//BERT-4516 starts...
function userAccountActivation() {
    var nonEmp = document.getElementById("divShareLink");
    var emplogin = document.getElementById("divEmplogins");
    var divInvalidUser = document.getElementById("divInvalidUser");
    var forgotPassword = document.getElementById("divForgotPassword");
    var forgotPasswordConfirmation = document.getElementById("divForgotPasswordConfirmation");
    var forgotPasswordInvalid = document.getElementById("divForgotPasswordInvalidEmail");

    var empLoginAccActivation = document.getElementById("divEmpActivationMail");
    var empLoginDet = document.getElementById("divEmpLogAccount");
    var empAccountActivation = document.getElementById("divAccountActivation");

    var empNotRegistered = document.getElementById("divEmpNotRegistered");

    emplogin.style.display = "block";
    empLoginAccActivation.style.display = "block";
    empAccountActivation.style.display = "none";
    empLoginDet.style.display = "none";
    forgotPassword.style.display = "none";
    forgotPasswordConfirmation.style.display = "none";
    nonEmp.style.display = "none";
    empNotRegistered.style.display = "none";

    try {
        divInvalidUser.style.display = "none";
    } catch (err) { }

}

function ActivationEmailResend() {
    var email = document.getElementById("txtEmailId").value;
    if ((checkEmail(email) == true)) {
        var strUrl = "/Handlers/WidgetEmployeeLogin.ashx?Email=" + email + "&pageType=emailresend";
        RaiseRequestToHandler(strUrl);
    }

}

function showAccountActivation() {
    var emplogin = document.getElementById("divEmplogins");
    var empLoginAccActivation = document.getElementById("divEmpActivationMail");
    var empAccountActivation = document.getElementById("divAccountActivation");
    var empLogDetail = document.getElementById("divEmpLogAccount");

    try {
        emplogin.style.display = "none";
        empLogDetail.style.display = "none";
        empLoginAccActivation.style.display = "none";
        empAccountActivation.style.display = "block";
    } catch (err) { }

}

//BERT-4516 ends

function ForgotPasswordHandler() {
    var emailErrorRequired = document.getElementById("emailErrorRequiredFP");
    var emailError = document.getElementById("emailErrorInvalidFP");


    emailErrorRequired.style.display = "none";
    emailError.style.display = "none";


    var email = document.getElementById("txtEmailIdFP").value;

    if ((email == 'Email Address')) {
        emailErrorRequired.style.display = "block";
        return false;
    }

    if ((checkEmail(email) == true)) {

        //        alert("Password Sent.");
        //        var strUrl = "/Handlers/WidgetEmployeeLogin.ashx?Email=" + email + "&Password=" + Password;
        var strUrl = "/Handlers/WidgetEmployeeLogin.ashx?Email=" + email + "&pageType=forgotPassword";
        //        window.open(strUrl, "test", "width=10,height=10,resizable=no,center=no,z-lock=no");
        //        $(window)[0].parent.focus()

        RaiseRequestToHandler(strUrl);

    }
    else {
        emailError.style.display = "block";

    }

}


function shareFacebookHandler() {

    //    var divFbSocialNetworkMsg = document.getElementById("divFbSocialNetworkMsg");/// BERT 7333
    //BERT-7068 starts...    
    var wwm4widgetjobshare = document.getElementById("wwm4widget-job-share");
    //divFbSocialNetworkMsg.style.display = "block";/// BERT 7333
    wwm4widgetjobshare.style.display = "none";
    //BERT-7068 ends
}
function shareTwitterHandler() {

    //    var divFbSocialNetworkMsg = document.getElementById("divFbSocialNetworkMsg");/// BERT 7333
    //BERT-7068 starts...
    //divFbSocialNetworkMsg.style.display = "none";/// BERT 7333    
    var wwm4widgetjobshare = document.getElementById("wwm4widget-job-share");
    wwm4widgetjobshare.style.display = "block";
    if (document.getElementById("blanket") != null) {
        document.getElementById('blanket').style.display = 'block';
    }
    else {
        //Adding a blanket container to the page
        if (document.getElementById("divMain") != null) {
            $('<div id="blanket" class="blanket" style="display:none;"></div>').appendTo('#divMain');
        }
        document.getElementById('blanket').style.display = 'block';
    }
    //BERT-7068 ends
}

function shareLinkedinHandler() {

    //    var divFbSocialNetworkMsg = document.getElementById("divFbSocialNetworkMsg");/// BERT 7333
    //divFbSocialNetworkMsg.style.display = "none";/// BERT 7333
    //BERT-7068 starts...  
    var wwm4widgetjobshare = document.getElementById("wwm4widget-job-share");
    wwm4widgetjobshare.style.display = "block";
    if (document.getElementById("blanket") != null) {
        document.getElementById('blanket').style.display = 'block';
    }
    else {
        //Adding a blanket container to the page
        if (document.getElementById("divMain") != null) {
            $('<div id="blanket" class="blanket" style="display:none;"></div>').appendTo('#divMain');
        }
        document.getElementById('blanket').style.display = 'block';
    }
    //BERT-7068 ends
}

//BERT-7068 starts...
function shareSocialNetworkHandler(varSocialNetwork) {
  
    socialNetwork = varSocialNetwork;
    if (widgetResponse == null) {
        try {
            widgetResponse = widgetPopupContent;
        }
        catch (e) {
        }
        processWidgetResponse(widgetResponse);
    }
    else {
        processWidgetResponse(widgetResponse);
    }


}

//Save the response received from wwm4 webservice
function processWidgetResponse(response) {

    widgetResponse = response;

    switch (socialNetwork) {
        case snTwitter:
            showWidgetContents();
            showSocialNetworkShareHandler(snTwitter);
            break;
        case snLinkedIn:
            showWidgetContents();
            showSocialNetworkShareHandler(snLinkedIn);
            break;
        case "Mail not sent !!!":
            showShareResult();
            if (widgetResponse != null) {
                var hdnSharePostMailFailedTitle = widgetResponse.SharePostMailFailedTitle;
                var hdnSharePostMailFailedClose = widgetResponse.SharePostMailFailedClose;
                var hdnSharePostMailFailedBlurb = widgetResponse.SharePostMailFailedBlurb;
            }
            document.getElementById("share-response-headertitle").innerHTML = hdnSharePostMailFailedTitle;
            document.getElementById("share-response-close").title = hdnSharePostMailFailedClose;
            document.getElementById("share-response-close").onclick = function() { CloseShareDiv(); };
            document.getElementById("share-response-msg").innerHTML = hdnSharePostMailFailedBlurb;
            break;
        default: break;
    }
}

function processEmailResponse(response) {
  
    emailResponse = response;
    showEmailContents();
    showEmailShare('sendEmail');
}

function showWidgetContents() {
    $('#wwm4widget-job-share').empty();
    $('<div class="popup-headline"><h2 id="show-share-headertitle"></h2><a id="share-popup-close" class="popup-close" title="Close">Close</a></div><div class="popup-body"><label id="share-msg-header" for="socialnetwork-share-msg" class="popup-msg-headline"></label><input name="socialnetwork-share-msg" id="socialnetwork-share-msg" type="text" value="Check out this job!" class="get-share-msg" /><a id="socialnetwork-sharelnk" class="popup-sharelnk" title="Share"></a><p class="popup-msgcharacter-container"><span id="show-share-msg-charcount"></span><span id="show-share-msg-remcharcount"></span></p></div>').appendTo('#wwm4widget-job-share');
    $("#show-share-headertitle").attr("tabindex", "-1").focus();
}

function showEmailContents() {
    $('#wwm4widget-job-share').empty();
    $('<div class="popup-headline"><h2 id="show-email-share-title"></h2><a id="email-share-closelnk" title="Close">Close</a></div><div class="popup-body"><label id="show-email-share-fromaddressheader" for="email-share-fromaddress" class="email-popup-address"></label><input type="email" id="email-share-fromaddress" aria-required="true"><label id="show-email-share-toaddressheader" for="email-share-toaddress" class="email-popup-address"></label><input type="email" id="email-share-toaddress" aria-required="true" /><label id="show-email-share-msgheader" for="email-share-message" class="email-popup-address"></label><textarea name="email-share-message" cols="500" rows="10" id="email-share-message" aria-required="true"></textarea><p class="popup-msgcharacter-container"><span id="show-email-msg-charcount"></span><span id="show-email-msg-remcharcount"></span></p><a id="email-share-closebtn" title="Cancel"></a><a id="email-share-sendbtn" title="Send"></a></div>').appendTo('#wwm4widget-job-share');
    $("#show-email-share-title").attr("tabindex", "-1").focus();
}

function showEmailSentContents() {
    $('#wwm4widget-job-share').empty();
    $('<div class="popup-headline"><h2 id="show-email-share-title"></h2><a id="email-share-closelnk" title="Close">Close</a></div><div class="popup-body"><label id="show-email-share-fromaddressheader" for="show-email-share-fromaddress" class="email-popup-address"></label><span id="show-email-share-fromaddress" class="email-address-overflow"></span><label id="show-email-share-toaddressheader" for="show-email-share-toaddress" class="email-popup-address"></label> <span id="show-email-share-toaddress" class="email-address-overflow"></span><label id="show-email-share-msgheader" for="show-email-share-msg" class="email-popup-address"></label> <span name="show-email-share-msg" id="show-email-share-msg" class="email-address-overflow"></span><a id="email-share-closebtn" title="Close"></a></div>').appendTo('#wwm4widget-job-share');
    $("#show-email-share-title").attr("tabindex", "-1").focus();
}

function showSocialNetworkShareHandler(varSocialNetwork) {

    var jobPostHeader = document.getElementById("show-share-headertitle");
    var lnkSocialNetworkClose = document.getElementById("share-popup-close");
    var lblSocialMsgPost = document.getElementById("share-msg-header");
    var txtSocialMsgPost = document.getElementById("socialnetwork-share-msg");
    var lnkSocialNetworkMsgShare = document.getElementById("socialnetwork-sharelnk");
    var charsRemainingText = document.getElementById("show-share-msg-remcharcount");
    var remainingLen = document.getElementById("show-share-msg-charcount");

    if (document.getElementById('blanket') != null) {
        document.getElementById('blanket').style.display = 'block';
    }
    else {
        //Adding a blanket container to the page
        if (document.getElementById("divMain") != null) {
            $('<div id="blanket" class="blanket" style="display:none;"></div>').appendTo('#divMain');
        }
        document.getElementById('blanket').style.display = 'block';
    }

    var divWWM4WidgetJobShare = document.getElementById("wwm4widget-job-share");
    divWWM4WidgetJobShare.style.display = "block";

    switch (varSocialNetwork) {
        case snTwitter:

            if (widgetResponse != null) {
                jobPostHeader.innerHTML = widgetResponse.SharePostTWTitle; //document.getElementById("hdnSharePostTWTitle").value;
                lnkSocialNetworkClose.title = widgetResponse.SharePostTWClose; //document.getElementById("hdnSharePostTWClose").value;
                lblSocialMsgPost.innerHTML = widgetResponse.SharePostTWTitleBlurb; //document.getElementById("hdnSharePostTWTitleBlurb").value;
                txtSocialMsgPost.value = widgetResponse.SharePostTWTextbox; //document.getElementById("hdnSharePostTWTextbox").value;
                lnkSocialNetworkMsgShare.title = widgetResponse.SharePostTWSharelnk; //document.getElementById("hdnSharePostTWSharelnk").value;
                lnkSocialNetworkMsgShare.innerHTML = widgetResponse.SharePostTWSharelnk; //document.getElementById("hdnSharePostTWSharelnk").value;
                charsRemainingText.innerHTML = widgetResponse.SharePostTWFieldLen; //document.getElementById("hdnSharePostTWFieldLen").value;
            }
            remainingLen.innerHTML = snTwitterMaxLen - txtSocialMsgPost.value.length;
            lnkSocialNetworkClose.onclick = function() { CloseShareDiv(); };
            lnkSocialNetworkMsgShare.onclick = function() { shareSocialNetworkHandlerMsg(snTwitter); };
            txtSocialMsgPost.onfocus = function() { ShareClearText(snTwitter); };
            txtSocialMsgPost.onblur = function() { ShareFillText(snTwitter); };
            txtSocialMsgPost.onkeyup = function() { CheckSocialNetworkFieldLength(txtSocialMsgPost, remainingLen, snTwitterMaxLen); };
            txtSocialMsgPost.onkeydown = function() { CheckSocialNetworkFieldLength(txtSocialMsgPost, remainingLen, snTwitterMaxLen); };
            break;
        case snLinkedIn:
            if (widgetResponse != null) {
                jobPostHeader.innerHTML = widgetResponse.SharePostLIShareTitle; //document.getElementById("hdnSharePostLIShareTitle").value;
                lnkSocialNetworkClose.title = widgetResponse.SharePostLIClose; //document.getElementById("hdnSharePostLIClose").value;
                lblSocialMsgPost.innerHTML = widgetResponse.SharePostLITitleBlurb; //document.getElementById("hdnSharePostLITitleBlurb").value;
                txtSocialMsgPost.value = widgetResponse.SharePostTWTextbox; //document.getElementById("hdnSharePostTWTextbox").value;
                lnkSocialNetworkMsgShare.title = widgetResponse.SharePostLIShareLnk; //document.getElementById("hdnSharePostLIShareLnk").value;
                lnkSocialNetworkMsgShare.innerHTML = widgetResponse.SharePostLIShareLnk; //document.getElementById("hdnSharePostLIShareLnk").value;
                charsRemainingText.innerHTML = widgetResponse.SharePostLIFieldLen; //document.getElementById("hdnSharePostLIFieldLen").value;
            }

            remainingLen.innerHTML = snLinkedInMaxLen - txtSocialMsgPost.value.length; ;
            lnkSocialNetworkClose.onclick = function() { CloseShareDiv(); };
            lnkSocialNetworkMsgShare.onclick = function() { shareSocialNetworkHandlerMsg(snLinkedIn); };
            txtSocialMsgPost.onfocus = function() { ShareClearText(snLinkedIn); };
            txtSocialMsgPost.onblur = function() { ShareFillText(snLinkedIn); };
            txtSocialMsgPost.onkeyup = function() { CheckSocialNetworkFieldLength(txtSocialMsgPost, remainingLen, snLinkedInMaxLen); };
            txtSocialMsgPost.onkeydown = function() { CheckSocialNetworkFieldLength(txtSocialMsgPost, remainingLen, snLinkedInMaxLen); };
            break;
        default:
            break;
    }
}

function CheckSocialNetworkFieldLength() {

    var arguments = CheckSocialNetworkFieldLength.arguments;
    var fn = arguments[0];
    var rn = arguments[1];
    var mc = arguments[2];

    var len = fn.value.length;
    if (len > mc) {
        fn.value = fn.value.substring(0, mc);
        len = mc;
    }
    rn.innerHTML = mc - len;
}

function shareSocialNetworkHandlerMsg(varSocialNetwork) {

    var hdnCurrentUrl = document.getElementById("hdnCurrentUrl");
    if (document.getElementById('blanket') != null) {
        document.getElementById('blanket').style.display = 'block';
    }
    else {
        //Adding a blanket container to the page
        if (document.getElementById("divMain") != null) {
            $('<div id="blanket" class="blanket" style="display:none;"></div>').appendTo('#divMain');
        }
        document.getElementById('blanket').style.display = 'block';
    }
    var txtSocialMsgPost = document.getElementById("socialnetwork-share-msg");

    var divWWM4WidgetJobShare = document.getElementById("wwm4widget-job-share");
    divWWM4WidgetJobShare.style.display = "block";
    showLoadImage();
    var strUrl = '';
    switch (varSocialNetwork) {
        case snTwitter:
            strUrl = "/Handlers/WidgetSocialShare.ashx?SocialNetwork=" + snTwitter + "&Message=" + txtSocialMsgPost.value + "&CurrentURL=" + hdnCurrentUrl.value;
            break;
        case snLinkedIn:
            strUrl = "/Handlers/WidgetSocialShare.ashx?SocialNetwork=" + snLinkedIn + "&Message=" + txtSocialMsgPost.value + "&CurrentURL=" + hdnCurrentUrl.value;
            break;
        default:
            break;
    }
    //    window.open(strUrl, "test", "width=10,height=10,resizable=no,center=no,z-lock=no");
    //    $(window)[0].parent.focus()

    //BERT 8371 Start
    if (strUrl.indexOf("#") >= 0) {
        var Re = new RegExp("#", "g");
        strUrl = strUrl.replace(Re, "%23");
    }
    //BERT 8371 End
    RaiseRequestToHandler(strUrl);
}

function showLoadImage() {
    
    var loadingImageUrl = document.getElementById("widget-load-image-url").value;
    $('.popup-body').remove();
    $('<div class="popup-body"><img alt="SocialNetworkSharing" src="' + loadingImageUrl + '" id="share-load-image"></img></div>");').appendTo('#wwm4widget-job-share');
}

function shareFacebookHandlerMsg() {

    if (document.getElementById('blanket') != null) {
        document.getElementById('blanket').style.display = 'none';
    }
    else {
        //Adding a blanket container to the page
        if (document.getElementById("divMain") != null) {
            $('<div id="blanket" class="blanket" style="display:none;"></div>').appendTo('#divMain');
        }
    }
    //BERT-7068 ends
    var hdnCurrentUrl = document.getElementById("hdnCurrentUrl");

    var friendList = document.getElementById("friendCombo");
    var userID = friendList.options[friendList.selectedIndex].value;


    //    var divSocialNetworkMsg = document.getElementById("divFbSocialNetworkMsg");/// BERT 7333
    var txtFbMsgSocialPost = document.getElementById("txtFbMsgSocialPost");
    divSocialNetworkMsg.style.display = "none";

    var strUrl = "/Handlers/WidgetSocialShare.ashx?SocialNetwork=facebook&Message=" + txtFbMsgSocialPost.value + "&CurrentURL=" + hdnCurrentUrl.value + "&fbUserID=" + userID;
    //    window.open(strUrl, "test", "width=10,height=10,resizable=no,center=no,z-lock=no");
    //    $(window)[0].parent.focus()
    
    //BERT 8371 Start
    if (strUrl.indexOf("#") >= 0) {
        var Re = new RegExp("#", "g");
        strUrl = strUrl.replace(Re, "%23");
    }
    //BERT 8371 End
    
    RaiseRequestToHandler(strUrl);

    //    return false;
}


function shareTwitterHandlerMsg() {
    var hdnCurrentUrl = document.getElementById("hdnCurrentUrl");
    //BERT-7068 starts...
    if (document.getElementById('blanket') != null) {
        document.getElementById('blanket').style.display = 'none';
    }
    else {
        //Adding a blanket container to the page
        if (document.getElementById("divMain") != null) {
            $('<div id="blanket" class="blanket" style="display:none;"></div>').appendTo('#divMain');
        }
    }
    //BERT-7068 ends

    var divSocialNetworkMsg = document.getElementById("divTwSocialNetworkMsg");
    var txtTwMsgSocialPost = document.getElementById("txtTwMsgSocialPost");
    divSocialNetworkMsg.style.display = "none";


    var strUrl = "/Handlers/WidgetSocialShare.ashx?SocialNetwork=twitter&Message=" + txtTwMsgSocialPost.value + "&CurrentURL=" + hdnCurrentUrl.value;
    //    window.open(strUrl, "test", "width=10,height=10,resizable=no,center=no,z-lock=no");
    //    $(window)[0].parent.focus()
    
    //BERT 8371 Start
    if (strUrl.indexOf("#") >= 0) {
        var Re = new RegExp("#", "g");
        strUrl = strUrl.replace(Re, "%23");
    }
    //BERT 8371 End
    RaiseRequestToHandler(strUrl);

    //    return false;
}


function shareLinkedInHandlerMsg() {
    var hdnCurrentUrl = document.getElementById("hdnCurrentUrl");
    //BERT-7068 starts...
    if (document.getElementById('blanket') != null) {
        document.getElementById('blanket').style.display = 'none';
    }
    else {
        //Adding a blanket container to the page
        if (document.getElementById("divMain") != null) {
            $('<div id="blanket" class="blanket" style="display:none;"></div>').appendTo('#divMain');
        }
    }
    //BERT-7068 ends

    var divSocialNetworkMsg = document.getElementById("divLnSocialNetworkMsg");
    var txtLnMsgSocialPost = document.getElementById("txtLnMsgSocialPost");
    divSocialNetworkMsg.style.display = "none";


    var strUrl = "/Handlers/WidgetSocialShare.ashx?SocialNetwork=linkedin&Message=" + txtLnMsgSocialPost.value + "&CurrentURL=" + hdnCurrentUrl.value;
    //    window.open(strUrl, "test", "width=10,height=10,resizable=no,center=no,z-lock=no");
    //    $(window)[0].parent.focus()
    
    //BERT 8371 Start
    if (strUrl.indexOf("#") >= 0) {
        var Re = new RegExp("#", "g");
        strUrl = strUrl.replace(Re, "%23");
    }
    //BERT 8371 End
    RaiseRequestToHandler(strUrl);

    //    return false;
}

//BERT-7068 starts...
function postingResult() {
    var arguments = postingResult.arguments;
    var result = arguments[0];

    var txtMyEmailAddressSent = document.getElementById("show-email-share-fromaddress");
    var txtRecipientMessageSent = document.getElementById("show-email-share-toaddress");
    var txtEmailMessageSent = document.getElementById("show-email-share-msg");

    //    var divFbSocialNetworkMsg = document.getElementById("divFbSocialNetworkMsg");/// BERT 7333 
    var jobShareConfirmHeader = document.getElementById("share-response-headertitle");
    var lnkShareConfirmClose = document.getElementById("share-response-close");
    var shareConfirmMsg = document.getElementById("share-response-msg");

    var hdnTwPostSuccess = document.getElementById("hdnTwPostSuccess").value;
    var hdnLnPostSuccess = document.getElementById("hdnLnPostSuccess").value;
    var hdnTwPostFail = document.getElementById("hdnTwPostFail").value;
    var hdnLnPostFail = document.getElementById("hdnLnPostFail").value;

    //divFbSocialNetworkMsg.style.display = "none";/// BERT 7333    

    if (document.getElementById("show-load-imgbox") != null) {
        document.getElementById("show-load-imgbox").style.display = 'none';
    }

    if (widgetResponse != null) {
        var hdnSharePostSuccessTitle = widgetResponse.SharePostSuccessTitle;  //document.getElementById("hdnSharePostSuccessTitle").value;
        var hdnSharePostSuccessClose = widgetResponse.SharePostSuccessClose;  //document.getElementById("hdnSharePostSuccessClose").value;
        var hdnSharePostSuccessConf = widgetResponse.SharePostSuccessConf; //document.getElementById("hdnSharePostSuccessConf").value;
        var hdnSharePostFailedTitle = widgetResponse.SharePostFailedTitle; // document.getElementById("hdnSharePostFailedTitle").value;
        var hdnSharePostFailedClose = widgetResponse.SharePostFailedClose; //document.getElementById("hdnSharePostFailedClose").value;
        var hdnSharePostFailedConf = widgetResponse.SharePostFailedConf; //document.getElementById("hdnSharePostFailedConf").value;
    }

    switch (result) {
        case "Mail not sent !!!":
            shareSocialNetworkHandler("Mail not sent !!!")
            break;
        case "Mail sent":
            showEmailSentContents();
            showEmailShare('emailSent');
            break;
        case "Twitter Posted":
            showShareResult();
            document.getElementById("share-response-headertitle").innerHTML = hdnSharePostSuccessTitle;
            document.getElementById("share-response-close").title = hdnSharePostSuccessClose;
            document.getElementById("share-response-close").onclick = function() { CloseShareDiv(); };
            document.getElementById("share-response-msg").innerHTML = hdnTwPostSuccess;
            break;
        case "Twitter Not Posted":
            showShareResult();
            document.getElementById("share-response-headertitle").innerHTML = hdnSharePostFailedTitle;
            document.getElementById("share-response-close").title = hdnSharePostFailedClose;
            document.getElementById("share-response-close").onclick = function() { CloseShareDiv(); };
            document.getElementById("share-response-msg").innerHTML = hdnTwPostFail;
            break;
        case "LinkedIn Posted":
            showShareResult();
            document.getElementById("share-response-headertitle").innerHTML = hdnSharePostSuccessTitle;
            document.getElementById("share-response-close").title = hdnSharePostSuccessClose;
            document.getElementById("share-response-close").onclick = function() { CloseShareDiv(); };
            document.getElementById("share-response-msg").innerHTML = hdnLnPostSuccess;
            break;
        case "LinkedIn Not Posted":
            showShareResult();
            document.getElementById("share-response-headertitle").innerHTML = hdnSharePostFailedTitle;
            document.getElementById("share-response-close").title = hdnSharePostFailedClose;
            document.getElementById("share-response-close").onclick = function() { CloseShareDiv(); };
            document.getElementById("share-response-msg").innerHTML = hdnLnPostFail;
            break;
        case "Posted.":
            showShareResult();
            document.getElementById("share-response-headertitle").innerHTML = hdnSharePostSuccessTitle;
            document.getElementById("share-response-close").title = hdnSharePostSuccessClose;
            document.getElementById("share-response-close").onclick = function() { CloseShareDiv(); };
            document.getElementById("share-response-msg").innerHTML = hdnSharePostSuccessConf;
            break;
        case "Not Posted.":
            showShareResult();
            document.getElementById("share-response-headertitle").innerHTML = hdnSharePostFailedTitle;
            document.getElementById("share-response-close").title = hdnSharePostFailedClose;
            document.getElementById("share-response-close").onclick = function() { CloseShareDiv(); };
            document.getElementById("share-response-msg").innerHTML = document.getElementById("SharePostFailedConf").value;
            break;
        default:
            break;
    }
}

function showShareResult() {

    $('#wwm4widget-job-share').empty();
    $('<div class="popup-headline"><h2 id="share-response-headertitle"></h2><a id="share-response-close" class="popup-close" title="Close">Close</a></div><div class="popup-body"><p id="share-response-msg" class="share-response-popup-msg"></p></div>').appendTo('#wwm4widget-job-share');
    $("#share-response-headertitle").attr("tabindex", "-1").focus();

    document.getElementById('wwm4widget-job-share').style.display = 'block';
    if (document.getElementById('blanket') != null) {
        document.getElementById('blanket').style.display = 'block';
    }
    else {
        //Adding a blanket container to the page
        if (document.getElementById("divMain") != null) {
            $('<div id="blanket" class="blanket" style="display:none;"></div>').appendTo('#divMain');
        }
        document.getElementById('blanket').style.display = 'block';
    }

}
//BERT-7068 ends

var userLoginEmailID = "";

//BERT 4525 - Start
var userLoginToken = "";
//BERT 4525 - End

function successLogin() {

    var arguments = successLogin.arguments;
    var msgWelocmeUser = arguments[0];
    var facebook = arguments[1];
    var twitter = arguments[2];
    var linkedIn = arguments[3];
    var emailID = arguments[4];
    var jobUrlFB = arguments[5];
    var strImage = arguments[6];
    var JobTitle = arguments[7];
    var strMessage = arguments[8];
    //BERT 4525 - Start
    var token = arguments[9];
    //BERT 4525 - End

    document.getElementById("hdnFbEmpShareLink").value = jobUrlFB;

    var nonEmp = document.getElementById("divShareLink");
    var emplogin = document.getElementById("divEmplogins");
    var empShare = document.getElementById("divEmpShare");
    var invalidLogin = document.getElementById("divInvalidUser");

    nonEmp.style.display = "none";
    emplogin.style.display = "none";
    empShare.style.display = "block";


    try {
        invalidLogin.style.display = "none";
    } catch (err) { }



    document.getElementById("lblEmployeeName").innerHTML = msgWelocmeUser;
    //BERT-7068 starts
    //document.getElementById("email-share-fromaddress").value = emailID;
    document.getElementById("hdnEmpEmail").value = emailID;

    userLoginEmailID = emailID;
    //BERT 4525 - Start
    userLoginToken = token;
    //BERT 4525 - End

    //if (document.getElementById("email-share-fromaddress").value == emailID) {
    //document.getElementById("email-share-fromaddress").disabled = true;
    //}

    var fbShare = document.getElementById("divFbEmpShare");
    if (facebook == "facebook") {
        fbShare.style.display = "block";
    }
    //BERT 9800 - Start
    else {
        fbShare.style.display = "none";
    }
    //BERT 9800 - End

    var twShare = document.getElementById("divTwEmpShare");
    if (twitter == "twitter") {
        twShare.style.display = "block";
    }
    //BERT 9800 - Start
    else {
        twShare.style.display = "none";
    }
    //BERT 9800 - End
    
    var lnShare = document.getElementById("divLnEmpShare");
    if (linkedIn == "linkedin") {
        lnShare.style.display = "block";
    }
    //BERT 9800 - Start
    else {
        lnShare.style.display = "none";
    }
    //BERT 9800 - End
    
    //BERT-7068 ends
    // BERT - 4521 - Start
    $("#WWM4Logout").focus();
    // BERT - 4521 - End

}



function redirectMySettings() {
    try {

        var MicrositeUrl = document.getElementById("hdnMicrositeUrl").value;
        // BERT - 4525 - Start
        var strUrl = MicrositeUrl + "/" + userLoginToken;
        // BERT - 4525 - End

        window.open(strUrl, "_new");
    }
    catch (Error) { }
}


function employeeLogout() {
    var strUrl = "/Handlers/WidgetEmployeeLogin.ashx?pageType=logout";
    //    window.open(strUrl, "test", "width=10,height=10,resizable=no,center=no,z-lock=no");
    //    $(window)[0].parent.focus()

    RaiseRequestToHandler(strUrl);

    return false;
}

function EmployeeLogoutRedirectToHome() {
    var emplogin = document.getElementById("divEmplogins");
    var empShare = document.getElementById("divEmpShare");

    empShare.style.display = "none";
    emplogin.style.display = "block";

    // BERT - 7362 - Start
    $($("#txtPassword")[0]).attr("style", "display:block");
    //    $($("#txtPasswordText")[0]).attr("style", "display:block");
    // BERT - 7362 - End
    
    // BERT - 4521 - Start
    $("#lnkLogin").focus();
    // BERT - 4521 - End

    //BERT-7068 starts...
    if (document.getElementById("hdnEmpEmail") != null) {
        document.getElementById("hdnEmpEmail").value = '';
    }
    //BERT-7068 ends
}
function shareFacebookEmpShare() {
    var jobUrlFB = document.getElementById("hdnFbEmpShareLink").value;
    var hdnCurrentUrl = document.getElementById("hdnCurrentUrl").value;
    var hdnstrImage = document.getElementById("hdnstrImage").value;
    var hdnJobTitle = document.getElementById("hdnJobTitle").value;
    var hdnJobDesc = document.getElementById("hdnJobDesc").value;
    var hdnShareJoblinkContent = document.getElementById("hdnShareJoblinkContent").value;



    var strUrl = "https://web.archive.org/web/20150106165400/http://www.facebook.com/sharer.php?s=100&p[url]=" + jobUrlFB + "&p[images][0]=" + hdnstrImage + "&p[title]=" + hdnJobTitle + "&p[summary]=" + hdnShareJoblinkContent;
    newwindow = window.open(strUrl, 'name', 'height=380,width=680,top=200,left=300,resizable');
    if (window.focus) { newwindow.focus() }
}


function unSuccessfullLogin() {

    var nonEmp = document.getElementById("divShareLink");
    var emplogin = document.getElementById("divEmplogins");
    var empShare = document.getElementById("divEmpShare");
    var invalidLogin = document.getElementById("divInvalidUser");


    try {
        invalidLogin.style.display = "block";
    } catch (err) { }

    nonEmp.style.display = "none";
    emplogin.style.display = "none";
    empShare.style.display = "none";

    //BERT-7068 starts...
    if (document.getElementById("email-share-fromaddress") != null) {
        document.getElementById("email-share-fromaddress").disabled = false;
    }
    //BERT-7068 ends

    // BERT - 4521 - Start
    $("#lnkNonRegUser").focus();
    // BERT - 4521 - End

}




function EmailClearText() {
    document.getElementById('txtEmailId').value = ''
    return false;
}

//BERT 6731
function EmailFillText() {
    if (document.getElementById('txtEmailId').value == '') {
        if (document.getElementById('hdnEmailText').value == '') {
            document.getElementById('txtEmailId').value = 'Email address';
        } else {
        document.getElementById('txtEmailId').value = document.getElementById('hdnEmailText').value;
        }
    }
    return false;
}
//BERT 6731


function EmailFBClearText() {
    document.getElementById('txtEmailIdFP').value = ''
    return false;
}

function EmailFBFillText() {
    if (document.getElementById('txtEmailIdFP').value == '') {
        document.getElementById('txtEmailIdFP').value = 'enter your e-mail address...';
    }
    return false;
}

//BERT-7068 starts...
function EmailMsgClearText() {

    if (emailResponse != null)
        var hdntxtEmailMessage = emailResponse.EmailPopupMessageBody;
    if (document.getElementById('email-share-message').value == '') {
        document.getElementById('email-share-message').value = '';
    }
    if (document.getElementById('email-share-message').value == hdntxtEmailMessage) {
        document.getElementById('email-share-message').value = '';
    }
    return false;
}

function ShareFillText(varSocialNetwork) {
    if (widgetResponse != null) {
        var hdntxtwMsgSocialPost = widgetResponse.SharePostTWTextbox;
        var hdntxtLnMsgSocialPost = widgetResponse.SharePostTWTextbox;
    }
    switch (varSocialNetwork) {
        case snTwitter:
            if (document.getElementById('socialnetwork-share-msg').value == '') {
                document.getElementById('socialnetwork-share-msg').value = hdntxtwMsgSocialPost;
                document.getElementById('show-share-msg-charcount').innerHTML = snTwitterMaxLen;
            }
            break;
        case snLinkedIn:
            if (document.getElementById('socialnetwork-share-msg').value == '') {
                document.getElementById('socialnetwork-share-msg').value = hdntxtLnMsgSocialPost;
                document.getElementById('show-share-msg-charcount').innerHTML = snLinkedInMaxLen;
            }
            break;
        default:
            break;
    }
    return false;
}

function ShareClearText(varSocialNetwork) {
    if (widgetResponse != null) {
        var hdntxtwMsgSocialPost = widgetResponse.SharePostTWTextbox;
        var hdntxtLnMsgSocialPost = widgetResponse.SharePostTWTextbox;
    }
    switch (varSocialNetwork) {
        case snTwitter:
            if (document.getElementById('socialnetwork-share-msg').value == '' || document.getElementById('socialnetwork-share-msg').value == hdntxtwMsgSocialPost) {
                document.getElementById('socialnetwork-share-msg').value = '';
                document.getElementById('show-share-msg-charcount').innerHTML = snTwitterMaxLen;
            }
            break;
        case snLinkedIn:
            if (document.getElementById('socialnetwork-share-msg').value == '' || document.getElementById('socialnetwork-share-msg').value == hdntxtLnMsgSocialPost) {
                document.getElementById('socialnetwork-share-msg').value = '';
                document.getElementById('show-share-msg-charcount').innerHTML = snLinkedInMaxLen;
            }
            break;
        default:
            break;
    }
    return false;
}

function EmailMsgFillText() {

    if (emailResponse != null) {
        var hdntxtEmailMessage = emailResponse.EmailPopupMessageBody;
    }
    if (document.getElementById('email-share-message').value == '') {
        document.getElementById('email-share-message').innerHTML = hdntxtEmailMessage;
        document.getElementById('email-share-message').value = hdntxtEmailMessage;
    }
    return false;
}
//BERT-7068 ends

function PwdClearText() {
    document.getElementById('txtPassword').value = '';
    document.getElementById('txtPassword').type = 'password';
    return false;
}

//BERT 7028 - Start
function PwdFieldSwitch() {

    $($("#txtPassword")[0]).attr("style", "display:block");
    $($("#txtPasswordText")[0]).attr("style", "display:none");
    document.getElementById('txtPassword').value == '';
    $($("#txtPassword")[0]).focus();    
    return false;
}

function PwdFillText() {
    if (document.getElementById('txtPassword').value == '') {
        $($("#txtPassword")[0]).attr("style", "display:none")
        $($("#txtPasswordText")[0]).attr("style", "display:block")
        
    }
    return false;
}
//BERT 7028 - End

function showPopupEmployee() {

}






















var is_initialized = false;

//        var url = "<%=xd_reciverUrl %>";
var url = "https://web.archive.org/web/20150106165400/http://www.jobsattmp.com/ERP/xd_receiver.htm";

//Commented by Amits on 3 March 2010//
//        var api_key = "<%=strFacebookApiKey %>";
var api_key = "288675501204228";




$(document).ready(function() {
    //BERT 4518 - Start

    LoginHandlerAtLoadTime();
	 //BERT 9317 - Start
    RegisterLoginEventsOnLoadTime();        
    //BERT 9317- End

    //BERT 4518 - End
});

//BERT 9317 - Start

function RegisterLoginEventsOnLoadTime() {

    if ($("#lnkLogin").length > 0) {
        $("#txtEmailId").keypress(function(key) {

            if (event.which == 13) {
                event.preventDefault()
                $("#lnkLogin").click();
            }
        });
        $("#txtPassword").keypress(function(key) {

            if (event.which == 13) {
                event.preventDefault()
                $("#lnkLogin").click();
            }
        });
    }
}

//BERT 9317- End

function ClearFriendList() {
    $("#friendCombo").html("");
}





var isLoaded = false;
var imgSrc = "";


(
    function() {
        var e = document.createElement('script'); e.async = false;
        e.src = document.location.protocol + '//web.archive.org/web/20150106165400/http://connect.facebook.net/en_US/all.js';

        e.onloadDone = false;
        e.onload = function() {
            e.onloadDone = true;

            CallFacebookFun();
        };
        e.onreadystatechange = function() {
            if (("loaded" === e.readyState || "complete" === e.readyState) && !e.onloadDone) {
                e.onloadDone = true;

                CallFacebookFun();
            }
        }
        if (document.getElementById('fb-root') != null) {
            document.getElementById('fb-root').appendChild(e);
        }
    } ()
);


function CallFacebookFun() {
    isLoaded = true;


    if (api_key == "") // required to have api_key if page is not opening from ERP.
    {
        bFromWWM = true;
        api_key = getFacebookApiKey();
        imgSrc = getFacebookClientImage();

    }

    var fbApiInitialized = false;

    FB.init({ appId: api_key, status: true, cookie: true, xfbml: true });
    FB.getLoginStatus(handleSessionResponse);
    function handleSessionResponse(response) {

        if (!response.authResponse) {


            document.getElementById("friendCombo").style.display = "none";


        }
        else {
            GetUserInfo();
        }


    }

    fbApiInitialized = true;
}

function getFacebookLogin() {
    FB.login(function(response) {
        if (response.authResponse) {
            if (response.status) {
                GetUserInfo();
            } else {
                return;
            }
        } else {
            return;
        }
    }, { scope: 'read_stream,publish_stream,offline_access' });
}


function GetUserInfo() {
    var sql = "SELECT uid, name FROM user WHERE uid IN (SELECT uid2 FROM friend WHERE uid1 =" + FB.getAuthResponse().userID + ")";
    var query = FB.Data.query(sql);
    var Options = "";
    query.wait(function(rows) {
        if (rows.length) {
            var markup = "";
            if (rows.length > 0) {

                var i = 0;
                ClearFriendList();
                var friendList = $("#friendCombo");
                Options = '<option value="' + FB.getAuthResponse().userID + '">My own wall</option>'; //Modified for BERT 1616 WWM
                for (var i = 0; i < rows.length; i++) {

                    var userID = rows[i]['uid'];
                    var userName = rows[i]['name'];
                    Options += '<option value="' + userID + '">' + userName + '\'s wall</option>'
                }
                friendList.html(Options);
            }

        } else {
            ClearFriendList();
            var friendList = $("#friendCombo");
            Options = '<option value="' + FB.getAuthResponse().userID + '">My own wall</option>'; //Modified for BERT 1616 WWM
            friendList.html(Options);
        }
    });

    var friendList = $("#friendCombo");

    try {
        Options += '<option value="' + FB.getAuthResponse().userID + '">My own wall</option>'; //Modified for BERT 1616 WWM
        friendList.html(Options);
    } catch (err) { }

    document.getElementById("friendCombo").style.display = "block";
}






function sendData() {
    var Message
    var OriginalMessage = "";
    if (document.all)
        Message = document.getElementById("divEditableMessage").innerText;
    else
        Message = document.getElementById("divEditableMessage").innerHTML;
    Message += "\n\r";
    OriginalMessage = Message;
    if (document.all)
        Message += document.getElementById("divJobLink").innerText;
    else
        Message += document.getElementById("divJobLink").innerHTML;
    if (Check() && CheckEditMode() && CheckSelection() && CheckMessageLength(Message, maxLength)) {
        var link = "sample TExt";
        var title = "sample TExt";
        var friendList = document.getElementById("friendCombo");
        var userID = friendList.options[friendList.selectedIndex].value;
        PostToFacebook(title + " at " + hdnCompanyName, link, OriginalMessage, userID);
    }
}




function PostToFacebook(title, linkmsg, desc, touser) {
    if (isLoaded) {
        FB.ui(
           {
               picture: imgSrc,
               method: 'feed',
               display: 'popup',
               name: title,
               caption: 'Click below to apply to this job opening.',
               link: linkmsg,
               description: '&nbsp;',
               message: desc,
               to: touser,
               actions: [{ name: 'Apply Here', link: linkmsg}]
           },
           function(response) {
               document.getElementById("pError").style.color = "Red";
               if (response) {
                   if (response.post_id) {
                       document.getElementById("pError").style.color = "Green";
                       document.getElementById("pError").innerHTML = "The message is successfully sent.";
                       if (!(typeof fromWWM == "undefined")) {
                           InsertUserActivity("facebook");
                       }
                       PopupClose();
                   }
                   else {
                       document.getElementById("pError").innerHTML = "Can't send data to Facebook. Please check input data.";
                   }
                   timedCount();
               }
               else {
                   document.getElementById("pError").innerHTML = "Data not sent to Facebook. Please edit the data and re-send, or close this window to make a different referral."; //"Can't send data to Facebook. Please check input data.";                  
                   timedCount();
               }
               document.getElementById("pSuccess").style.display = "none";
               document.getElementById("pError").style.display = "block";
           }
         );
    }
}


/*
     FILE ARCHIVED ON 16:54:00 Jan 06, 2015 AND RETRIEVED FROM THE
     INTERNET ARCHIVE ON 18:08:21 Nov 22, 2019.
     JAVASCRIPT APPENDED BY WAYBACK MACHINE, COPYRIGHT INTERNET ARCHIVE.

     ALL OTHER CONTENT MAY ALSO BE PROTECTED BY COPYRIGHT (17 U.S.C.
     SECTION 108(a)(3)).
*/
/*
playback timings (ms):
  captures_list: 173.509
  exclusion.robots: 0.208
  load_resource: 275.868
  RedisCDXSource: 0.987
  PetaboxLoader3.datanode: 80.323 (5)
  esindex: 0.014
  exclusion.robots.policy: 0.193
  LoadShardBlock: 43.838 (3)
  PetaboxLoader3.resolve: 188.193 (2)
  CDXLines.iter: 13.78 (3)
*/