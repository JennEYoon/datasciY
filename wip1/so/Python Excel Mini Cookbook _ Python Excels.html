<!DOCTYPE html>
<!-- saved from url=(0051)http://pythonexcels.com/python-excel-mini-cookbook/ -->
<html lang="en-US"><!--<![endif]--><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<meta name="viewport" content="width=device-width">
<title>Python Excel Mini Cookbook | Python Excels</title>
<link rel="profile" href="http://gmpg.org/xfn/11">
<link rel="stylesheet" type="text/css" media="all" href="./Python Excel Mini Cookbook _ Python Excels_files/style.css">
<link rel="pingback" href="http://pythonexcels.com/blog/xmlrpc.php">
<!--[if lt IE 9]>
<script src="http://pythonexcels.com/blog/wp-content/themes/twentyeleven/js/html5.js" type="text/javascript"></script>
<![endif]-->
<link rel="alternate" type="application/rss+xml" title="Python Excels » Feed" href="http://pythonexcels.com/feed/">
<link rel="alternate" type="application/rss+xml" title="Python Excels » Comments Feed" href="http://pythonexcels.com/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="Python Excels » Python Excel Mini Cookbook Comments Feed" href="http://pythonexcels.com/python-excel-mini-cookbook/feed/">
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/pythonexcels.com\/blog\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.4.18"}};
			!function(a,b,c){function d(a){var c,d,e,f=b.createElement("canvas"),g=f.getContext&&f.getContext("2d"),h=String.fromCharCode;return g&&g.fillText?(g.textBaseline="top",g.font="600 32px Arial","flag"===a?(g.fillText(h(55356,56806,55356,56826),0,0),f.toDataURL().length>3e3):"diversity"===a?(g.fillText(h(55356,57221),0,0),c=g.getImageData(16,16,1,1).data,g.fillText(h(55356,57221,55356,57343),0,0),c=g.getImageData(16,16,1,1).data,e=c[0]+","+c[1]+","+c[2]+","+c[3],d!==e):("simple"===a?g.fillText(h(55357,56835),0,0):g.fillText(h(55356,57135),0,0),0!==g.getImageData(16,16,1,1).data[0])):!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g;c.supports={simple:d("simple"),flag:d("flag"),unicode8:d("unicode8"),diversity:d("diversity")},c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.simple&&c.supports.flag&&c.supports.unicode8&&c.supports.diversity||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script><script src="./Python Excel Mini Cookbook _ Python Excels_files/wp-emoji-release.min.js.download" type="text/javascript"></script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel="https://api.w.org/" href="http://pythonexcels.com/wp-json/">
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://pythonexcels.com/blog/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://pythonexcels.com/blog/wp-includes/wlwmanifest.xml"> 
<link rel="prev" title="Basic Excel Driving with Python" href="http://pythonexcels.com/basic-excel-driving-with-python/">
<link rel="next" title="Mapping Excel VB Macros to Python" href="http://pythonexcels.com/mapping-excel-vb-macros-to-python/">
<meta name="generator" content="WordPress 4.4.18">
<link rel="canonical" href="http://pythonexcels.com/python-excel-mini-cookbook/">
<link rel="shortlink" href="http://pythonexcels.com/?p=41">
<link rel="alternate" type="application/json+oembed" href="http://pythonexcels.com/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fpythonexcels.com%2Fpython-excel-mini-cookbook%2F">
<link rel="alternate" type="text/xml+oembed" href="http://pythonexcels.com/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fpythonexcels.com%2Fpython-excel-mini-cookbook%2F&amp;format=xml">
		<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>
			<style type="text/css" id="twentyeleven-header-css">
			#site-title a,
		#site-description {
			color: #333 !important;
		}
		</style>
	</head>

<body class="single single-post postid-41 single-format-standard single-author singular two-column right-sidebar">
<div id="page" class="hfeed">
	<header id="branding" role="banner">
			<hgroup>
				<h1 id="site-title"><span><a href="http://pythonexcels.com/" title="Python Excels" rel="home">Python Excels</a></span></h1>
				<h2 id="site-description">Doing cool stuff with Python</h2>
			</hgroup>

						<a href="http://pythonexcels.com/">
									<img src="./Python Excel Mini Cookbook _ Python Excels_files/chessboard.jpg" width="1000" height="288" alt="">
							</a>
			
								<form method="get" id="searchform" action="http://pythonexcels.com/">
		<label for="s" class="assistive-text">Search</label>
		<input type="text" class="field" name="s" id="s" placeholder="Search">
		<input type="submit" class="submit" name="submit" id="searchsubmit" value="Search">
	</form>
			
			<nav id="access" role="navigation">
				<h3 class="assistive-text">Main menu</h3>
								<div class="skip-link"><a class="assistive-text" href="http://pythonexcels.com/python-excel-mini-cookbook/#content" title="Skip to primary content">Skip to primary content</a></div>
				<div class="skip-link"><a class="assistive-text" href="http://pythonexcels.com/python-excel-mini-cookbook/#secondary" title="Skip to secondary content">Skip to secondary content</a></div>
								<div class="menu"><ul><li><a href="http://pythonexcels.com/">Home</a></li><li class="page_item page-item-2"><a href="http://pythonexcels.com/sample-page/">About</a></li></ul></div>
			</nav><!-- #access -->
	</header><!-- #branding -->


	<div id="main">

		<div id="primary">
			<div id="content" role="main">

				
					<nav id="nav-single">
						<h3 class="assistive-text">Post navigation</h3>
						<span class="nav-previous"><a href="http://pythonexcels.com/basic-excel-driving-with-python/" rel="prev"><span class="meta-nav">←</span> Previous</a></span>
						<span class="nav-next"><a href="http://pythonexcels.com/mapping-excel-vb-macros-to-python/" rel="next">Next <span class="meta-nav">→</span></a></span>
					</nav><!-- #nav-single -->

					
<article id="post-41" class="post-41 post type-post status-publish format-standard hentry category-uncategorized">
	<header class="entry-header">
		<h1 class="entry-title">Python Excel Mini Cookbook</h1>

				<div class="entry-meta">
			<span class="sep">Posted on </span><a href="http://pythonexcels.com/python-excel-mini-cookbook/" title="1:00 pm" rel="bookmark"><time class="entry-date" datetime="2009-10-05T13:00:12+00:00">October 5, 2009</time></a><span class="by-author"> <span class="sep"> by </span> <span class="author vcard"><a class="url fn n" href="http://pythonexcels.com/author/dan/" title="View all posts by dan" rel="author">dan</a></span></span>		</div><!-- .entry-meta -->
			</header><!-- .entry-header -->

	<div class="entry-content">
		<p>To get you started, I’ve illustrated a number of common tasks you can do with Python and Excel. Each program below is a self contained example, just copy it, paste it and run it. A few things to note:</p>
<ul>
<li>These examples were tested in Excel 2007, they should work fine in earlier versions as well after changing the extension of the file within the&nbsp;<code>wb.SaveAs()</code>&nbsp;statement from .xlsx to .xls</li>
<li>If you’re new to this, I recommend typing these examples by hand into IDLE, IPython or the Python interpreter, then watching the effect in Excel as you enter the commands. To make Excel visible add the line&nbsp;<code>excel.Visible&nbsp;=&nbsp;True</code>&nbsp;after the&nbsp;<code>excel&nbsp;=win32.gencache.EnsureDispatch('Excel.Application')</code>&nbsp;line in the script</li>
<li>These are simple examples with no error checking. Make sure the output files doesn’t exist before running the script. If the script crashes, it may leave a copy of Excel running in the background. Open the Windows Task Manager and kill the background Excel process to recover.</li>
<li>These examples contain no optimization. You typically wouldn’t use a <code>for</code> loop to iterate through data in individual cells, it’s provided here for illustration only.</li>
</ul>
<p><strong>Open Excel, Add a Workbook</strong></p>
<p>The <a href="https://github.com/pythonexcels/examples/blob/master/add_a_workbook.py">following script</a> simply invokes Excel, adds a workbook and saves the empty workbook.</p>
<pre>#
# Add a workbook and save (Excel 2007)
# For older versions of excel, use the .xls file extension
#
import win32com.client as win32
excel = win32.gencache.EnsureDispatch('Excel.Application')
wb = excel.Workbooks.Add()
wb.SaveAs('add_a_workbook.xlsx')
excel.Application.Quit()</pre>
<p><strong>Open an Existing Workbook</strong></p>
<p><a href="https://github.com/pythonexcels/examples/blob/master/open_an_existing_workbook.py">This script</a> opens an existing workbook and displays it (note the statement&nbsp;<code>excel.Visible&nbsp;=True</code>). The file workbook1.xlsx must already exist in your “My Documents” directory. You can also open spreadsheet files by specifying the full path to the file as shown below. Using&nbsp;<code>r'</code>in the statement&nbsp;<code>r'C:\myfiles\excel\workbook2.xlsx'</code>&nbsp;automatically escapes the backslash characters and makes the file name a bit more concise.</p>
<pre>#
# Open an existing workbook
#
import win32com.client as win32
excel = win32.gencache.EnsureDispatch('Excel.Application')
wb = excel.Workbooks.Open('workbook1.xlsx')
# Alternately, specify the full path to the workbook 
# wb = excel.Workbooks.Open(r'C:\myfiles\excel\workbook2.xlsx')
excel.Visible = True</pre>
<p><strong>Add a Worksheet</strong></p>
<p><a href="https://github.com/pythonexcels/examples/blob/master/add_a_worksheet.py">This script</a> creates a new workbook with three sheets, adds a fourth worksheet and names it MyNewSheet.</p>
<pre>#
# Add a workbook, add a worksheet,
# name it 'MyNewSheet' and save
#
import win32com.client as win32
excel = win32.gencache.EnsureDispatch('Excel.Application')
wb = excel.Workbooks.Add()
ws = wb.Worksheets.Add()
ws.Name = "MyNewSheet"
wb.SaveAs('add_a_worksheet.xlsx')
excel.Application.Quit()</pre>
<p><strong>Ranges and Offsets</strong></p>
<p><a href="https://github.com/pythonexcels/examples/blob/master/ranges_and_offsets.py">This script</a> illustrates different techniques for addressing cells by using the&nbsp;<code>Cells()</code>&nbsp;and&nbsp;<code>Range()</code>operators. Individual cells can be addressed using&nbsp;<code>Cells(row,column)</code>, where&nbsp;<code>row</code>&nbsp;is the row number,&nbsp;<code>column</code>&nbsp;is the column number, both start from 1. Groups of cells can be addressed using&nbsp;<code>Range()</code>, where the argument in the parenthesis can be a single cell denoted by its textual name (eg&nbsp;<code>"A2"</code>), a group noted by a textual name with a colon (eg&nbsp;<code>"A3:B4"</code>) or a group denoted with two&nbsp;<code>Cells()</code>&nbsp;identifiers (eg&nbsp;<code>ws.Cells(1,1),ws.Cells(2,2)</code>). The&nbsp;<code>Offset</code>method provides a way to address a cell based on a reference to another cell.</p>
<pre>#
# Using ranges and offsets
#
import win32com.client as win32
excel = win32.gencache.EnsureDispatch('Excel.Application')
wb = excel.Workbooks.Add()
ws = wb.Worksheets("Sheet1")
ws.Cells(1,1).Value = "Cell A1"
ws.Cells(1,1).Offset(2,4).Value = "Cell D2"
ws.Range("A2").Value = "Cell A2"
ws.Range("A3:B4").Value = "A3:B4"
ws.Range("A6:B7,A9:B10").Value = "A6:B7,A9:B10"
wb.SaveAs('ranges_and_offsets.xlsx')
excel.Application.Quit()</pre>
<p><strong>Autofill Cell Contents</strong></p>
<p><a href="https://github.com/pythonexcels/examples/blob/master/autofill_cells.py">This script</a> uses Excel’s autofill capability to examine data in cells A1 and A2, then autofill the remaining column of cells through A10.</p>
<pre>#
# Autofill cell contents
#
import win32com.client as win32
excel = win32.gencache.EnsureDispatch('Excel.Application')
wb = excel.Workbooks.Add()
ws = wb.Worksheets("Sheet1")
ws.Range("A1").Value = 1
ws.Range("A2").Value = 2
ws.Range("A1:A2").AutoFill(ws.Range("A1:A10"),win32.constants.xlFillDefault)
wb.SaveAs('autofill_cells.xlsx')
excel.Application.Quit()</pre>
<p><strong>Cell Color</strong></p>
<p><a href="https://github.com/pythonexcels/examples/blob/master/cell_color.py">This script</a> illustrates adding an interior color to the cell using&nbsp;<code>Interior.ColorIndex</code>. Column A, rows 1 through 20 are filled with a number and assigned that&nbsp;<code>ColorIndex</code>.</p>
<pre>#
# Add an interior color to cells
#
import win32com.client as win32
excel = win32.gencache.EnsureDispatch('Excel.Application')
wb = excel.Workbooks.Add()
ws = wb.Worksheets("Sheet1")
for i in range (1,21):
    ws.Cells(i,1).Value = i
    ws.Cells(i,1).Interior.ColorIndex = i
wb.SaveAs('cell_color.xlsx')
excel.Application.Quit()</pre>
<p><strong>Column Formatting</strong></p>
<p><a href="https://github.com/pythonexcels/examples/blob/master/column_widths.py">This script</a> creates two columns of data, one narrow and one wide, then formats the column width with the&nbsp;<code>ColumnWidth</code>&nbsp;property. You can also use the&nbsp;<code>Columns.AutoFit()</code>&nbsp;function to autofit all columns in the spreadsheet.</p>
<pre>#
# Set column widths
#
import win32com.client as win32
excel = win32.gencache.EnsureDispatch('Excel.Application')
wb = excel.Workbooks.Add()
ws = wb.Worksheets("Sheet1")
ws.Range("A1:A10").Value = "A"
ws.Range("B1:B10").Value = "This is a very long line of text"
ws.Columns(1).ColumnWidth = 1
ws.Range("B:B").ColumnWidth = 27
# Alternately, you can autofit all columns in the worksheet
# ws.Columns.AutoFit()
wb.SaveAs('column_widths.xlsx')
excel.Application.Quit()</pre>
<p><strong>Copying Data from Worksheet to Worksheet</strong></p>
<p><a href="https://github.com/pythonexcels/examples/blob/master/copy_worksheet_to_worksheet.py">This script</a> uses the&nbsp;<code>FillAcrossSheets()</code>&nbsp;method to copy data from one location to all other worksheets in the workbook. Specifically, the data in the range A1:J10 is copied from Sheet1 to sheets Sheet2 and Sheet3.</p>
<pre>#
# Copy data and formatting from a range of one worksheet
# to all other worksheets in a workbook
#
import win32com.client as win32
excel = win32.gencache.EnsureDispatch('Excel.Application')
wb = excel.Workbooks.Add()
ws = wb.Worksheets("Sheet1")
ws.Range("A1:J10").Formula = "=row()*column()"
wb.Worksheets.FillAcrossSheets(wb.Worksheets("Sheet1").Range("A1:J10"))
wb.SaveAs('copy_worksheet_to_worksheet.xlsx')
excel.Application.Quit()</pre>
<p><strong>Format Worksheet Cells</strong></p>
<p><a href="https://github.com/pythonexcels/examples/blob/master/format_cells.py">This script</a> creates two columns of data, then formats the font type and font size used in the worksheet. Five different fonts and sizes are used, the numbers are formatted using a monetary format.</p>
<pre>#
# Format cell font name and size, format numbers in monetary format
#
import win32com.client as win32
excel = win32.gencache.EnsureDispatch('Excel.Application')
wb = excel.Workbooks.Add()
ws = wb.Worksheets("Sheet1")

for i,font in enumerate(["Arial","Courier New","Garamond","Georgia","Verdana"]):
    ws.Range(ws.Cells(i+1,1),ws.Cells(i+1,2)).Value = [font,i+i]
    ws.Range(ws.Cells(i+1,1),ws.Cells(i+1,2)).Font.Name = font
    ws.Range(ws.Cells(i+1,1),ws.Cells(i+1,2)).Font.Size = 12+i

ws.Range("A1:A5").HorizontalAlignment = win32.constants.xlRight
ws.Range("B1:B5").NumberFormat = "$###,##0.00"
ws.Columns.AutoFit()
wb.SaveAs('format_cells.xlsx')
excel.Application.Quit()</pre>
<p><strong>Setting Row Height</strong></p>
<p><a href="https://github.com/pythonexcels/examples/blob/master/row_height.py">This script</a> illustrates row height. Similar to column height, row height can be set with the&nbsp;<code>RowHeight</code>&nbsp;method. You can also use<code>AutoFit()</code>&nbsp;to automatically adjust the row height based on cell contents.</p>
<pre>#
# Set row heights and align text within the cell
#
import win32com.client as win32
excel = win32.gencache.EnsureDispatch('Excel.Application')
wb = excel.Workbooks.Add()
ws = wb.Worksheets("Sheet1")
ws.Range("A1:A2").Value = "1 line"
ws.Range("B1:B2").Value = "Two\nlines"
ws.Range("C1:C2").Value = "Three\nlines\nhere"
ws.Range("D1:D2").Value = "This\nis\nfour\nlines"
ws.Rows(1).RowHeight = 60
ws.Range("2:2").RowHeight = 120
ws.Rows(1).VerticalAlignment = win32.constants.xlCenter
ws.Range("2:2").VerticalAlignment = win32.constants.xlCenter

# Alternately, you can autofit all rows in the worksheet
# ws.Rows.AutoFit()

wb.SaveAs('row_height.xlsx')
excel.Application.Quit()</pre>
<p><strong>Prerequisites</strong></p>
<p>Python (refer to&nbsp;<a href="http://www.python.org/">http://www.python.org</a>)</p>
<p>Win32 Python module (refer to&nbsp;<a href="http://sourceforge.net/projects/pywin32">http://sourceforge.net/projects/pywin32</a>)</p>
<p>Microsoft Excel (refer to&nbsp;<a href="http://office.microsoft.com/excel">http://office.microsoft.com/excel</a>)</p>
<p><strong>Source Files and Scripts</strong></p>
<p>Source for the program and data text file are available at<a href="http://github.com/pythonexcels/examples">http://github.com/pythonexcels/examples</a></p>
<p>That’s all for now, thanks — Dan</p>
			</div><!-- .entry-content -->

	<footer class="entry-meta">
		This entry was posted in <a href="http://pythonexcels.com/category/uncategorized/" rel="category tag">Uncategorized</a> by <a href="http://pythonexcels.com/author/dan/">dan</a>. Bookmark the <a href="http://pythonexcels.com/python-excel-mini-cookbook/" title="Permalink to Python Excel Mini Cookbook" rel="bookmark">permalink</a>.		
			</footer><!-- .entry-meta -->
</article><!-- #post-41 -->

						<div id="comments">
	
	
	
	
</div><!-- #comments -->

				
			</div><!-- #content -->
		</div><!-- #primary -->


	</div><!-- #main -->

	<footer id="colophon" role="contentinfo">

			

			<div id="site-generator">
								<a href="http://wordpress.org/" title="Semantic Personal Publishing Platform">Proudly powered by WordPress</a>
			</div>
	</footer><!-- #colophon -->
</div><!-- #page -->

<script type="text/javascript" src="./Python Excel Mini Cookbook _ Python Excels_files/comment-reply.min.js.download"></script>
<script type="text/javascript" src="./Python Excel Mini Cookbook _ Python Excels_files/wp-embed.min.js.download"></script>


</body></html>